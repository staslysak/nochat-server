{"version":3,"sources":["pages/Login/index.js"],"names":["useStyles","makeStyles","theme","Login","display","justifyContent","flexDirection","alignItems","height","width","props","classes","React","useState","values","setValues","errors","setErrors","useRegisterMutation","register","useLoginMutation","login","isRegister","test","location","pathname","handleOnChange","target","name","value","prevValues","handleData","data","a","history","push","authTokens","set","onSubmit","e","preventDefault","variables","then","alert","catch","error","graphQLErrors","forEach","err","extensions","validationErrors","wsLink","subscriptionClient","tryReconnect","className","maxWidth","variant","gutterBottom","fullWidth","margin","onChange","username","label","helperText","email","password","type","align","component","Link","to"],"mappings":"qQAcMA,EAAYC,aAAW,SAACC,GAAD,MAAY,CACvCC,MAAO,CACLC,QAAS,OACTC,eAAgB,SAChBC,cAAe,SACfC,WAAY,SACZC,OAAQ,QACRC,MAAO,aAsIIN,UA1HD,SAACO,GACb,IAAMC,EAAUX,IADO,EAEKY,IAAMC,SAAS,IAFpB,mBAEhBC,EAFgB,KAERC,EAFQ,OAGKH,IAAMC,SAAS,IAHpB,mBAGhBG,EAHgB,KAGRC,EAHQ,OAIJC,cAAZC,EAJgB,sBAKPC,cAATC,EALgB,oBAMjBC,EAAa,iBAAiBC,KAAKb,EAAMc,SAASC,UAElDC,EAAiB,SAAC,GAAiC,IAAD,IAA9BC,OAAUC,EAAoB,EAApBA,KAAMC,EAAc,EAAdA,MACxCd,GAAU,SAACe,GAAD,sBAAsBA,EAAtB,eAAmCF,EAAOC,QAGhDE,EAAU,uCAAG,WAAOC,GAAP,SAAAC,EAAA,sDACbX,EACFZ,EAAMwB,QAAQC,KAAK,WAEnBC,IAAWC,IAAIL,GACftB,EAAMwB,QAAQC,KAAK,QAErBlB,EAAU,IAPO,2CAAH,sDAUVqB,EAAQ,uCAAG,WAAOC,GAAP,SAAAN,EAAA,yDACfM,EAAEC,kBACElB,EAFW,gCAGPH,EAAS,CAAEsB,UAAW3B,IACzB4B,MAAK,gBAAGV,EAAH,EAAGA,KAAH,OAAcD,EAAWC,EAAKb,aACnCuB,MAAK,kBAAMC,MAAM,uBACjBC,OAAM,SAACC,GACFA,EAAMC,eACRD,EAAMC,cAAcC,SAAQ,SAACC,GAAD,OAC1B/B,EAAU+B,EAAIC,WAAWC,wBATpB,6CAcP7B,EAAM,CAAEoB,UAAW3B,IACtB4B,MAAK,YAAe,IAAZV,EAAW,EAAXA,KACPD,EAAWC,EAAKX,OAChB8B,IAAOC,mBAAmBC,kBAE3BT,OAAM,SAACC,GACFA,EAAMC,eACRD,EAAMC,cAAcC,SAAQ,SAACC,GAAD,OAC1B/B,EAAU+B,EAAIC,WAAWC,wBAtBpB,2CAAH,sDAwEd,OACE,yBAAKI,UAAW3C,EAAQR,OACtB,kBAAC,IAAD,CAAKoD,SAAU,KACb,kBAAC,IAAD,CAAYC,QAAQ,KAAKC,cAAY,GAClCnC,EAAa,OAAS,SAEzB,0BAAMgB,SAAUA,GA/ClB,6BACE,kBAAC,IAAD,CACEoB,WAAS,EACTC,OAAO,QACPH,QAAQ,WACRI,SAAUlC,EACVG,MAAOf,EAAO+C,SACdC,MAAM,WACNlC,KAAK,WACLiB,MAAO7B,EAAO6C,SACdE,WAAY/C,EAAO6C,WAEpBvC,GACC,kBAAC,IAAD,CACEoC,WAAS,EACTC,OAAO,QACPH,QAAQ,WACRI,SAAUlC,EACVG,MAAOf,EAAOkD,MACdF,MAAM,QACNlC,KAAK,QACLiB,MAAO7B,EAAOgD,MACdD,WAAY/C,EAAOgD,QAGvB,kBAAC,IAAD,CACEN,WAAS,EACTC,OAAO,QACPH,QAAQ,WACRI,SAAUlC,EACVG,MAAOf,EAAOmD,SACdH,MAAM,WACNlC,KAAK,WACLsC,KAAK,WACLrB,MAAO7B,EAAOiD,SACdF,WAAY/C,EAAOiD,YAcnB,kBAAC,IAAD,CAAYE,MAAM,SAASX,QAAQ,QAAQC,cAAY,GACpDnC,EACC,kBAAC,IAAD,CAAS6C,MAAM,SAASC,UAAWC,IAAMC,GAAG,KAA5C,4BAIA,kBAAC,IAAD,CAASH,MAAM,SAASC,UAAWC,IAAMC,GAAG,iBAA5C,kBAKJ,kBAAC,IAAD,CAAQJ,KAAK,SAASR,WAAS,GAC5BpC,EAAa,OAAS","file":"static/js/8.4a8416e7.chunk.js","sourcesContent":["import React from \"react\";\r\nimport {\r\n  Box,\r\n  Button,\r\n  TextField,\r\n  Typography,\r\n  Link as MuiLink,\r\n} from \"@material-ui/core\";\r\nimport { useLoginMutation, useRegisterMutation } from \"graphql/generated.tsx\";\r\nimport { Link } from \"react-router-dom\";\r\nimport { makeStyles } from \"@material-ui/core/styles\";\r\nimport { wsLink } from \"client\";\r\nimport { authTokens } from \"utils/index\";\r\n\r\nconst useStyles = makeStyles((theme) => ({\r\n  Login: {\r\n    display: \"flex\",\r\n    justifyContent: \"center\",\r\n    flexDirection: \"column\",\r\n    alignItems: \"center\",\r\n    height: \"100vh\",\r\n    width: \"100vw\",\r\n  },\r\n  // Login: `\r\n  //   display: flex;\r\n  //   justify-content: center;\r\n  //   flex-direction: column;\r\n  //   align-items: center;\r\n  //   height: 100vh;\r\n  //   width: 100vw;\r\n  // `,\r\n}));\r\n\r\nconst Login = (props) => {\r\n  const classes = useStyles();\r\n  const [values, setValues] = React.useState({});\r\n  const [errors, setErrors] = React.useState({});\r\n  const [register] = useRegisterMutation();\r\n  const [login] = useLoginMutation();\r\n  const isRegister = /\\/registration/.test(props.location.pathname);\r\n\r\n  const handleOnChange = ({ target: { name, value } }) => {\r\n    setValues((prevValues) => ({ ...prevValues, [name]: value }));\r\n  };\r\n\r\n  const handleData = async (data) => {\r\n    if (isRegister) {\r\n      props.history.push(\"/login\");\r\n    } else {\r\n      authTokens.set(data);\r\n      props.history.push(\"/me\");\r\n    }\r\n    setErrors({});\r\n  };\r\n\r\n  const onSubmit = async (e) => {\r\n    e.preventDefault();\r\n    if (isRegister) {\r\n      await register({ variables: values })\r\n        .then(({ data }) => handleData(data.register))\r\n        .then(() => alert(\"Check your email\"))\r\n        .catch((error) => {\r\n          if (error.graphQLErrors) {\r\n            error.graphQLErrors.forEach((err) =>\r\n              setErrors(err.extensions.validationErrors)\r\n            );\r\n          }\r\n        });\r\n    } else {\r\n      await login({ variables: values })\r\n        .then(({ data }) => {\r\n          handleData(data.login);\r\n          wsLink.subscriptionClient.tryReconnect();\r\n        })\r\n        .catch((error) => {\r\n          if (error.graphQLErrors) {\r\n            error.graphQLErrors.forEach((err) =>\r\n              setErrors(err.extensions.validationErrors)\r\n            );\r\n          }\r\n        });\r\n    }\r\n  };\r\n\r\n  const renderFields = () => {\r\n    return (\r\n      <div>\r\n        <TextField\r\n          fullWidth\r\n          margin=\"dense\"\r\n          variant=\"outlined\"\r\n          onChange={handleOnChange}\r\n          value={values.username}\r\n          label=\"Username\"\r\n          name=\"username\"\r\n          error={errors.username}\r\n          helperText={errors.username}\r\n        />\r\n        {isRegister && (\r\n          <TextField\r\n            fullWidth\r\n            margin=\"dense\"\r\n            variant=\"outlined\"\r\n            onChange={handleOnChange}\r\n            value={values.email}\r\n            label=\"Email\"\r\n            name=\"email\"\r\n            error={errors.email}\r\n            helperText={errors.email}\r\n          />\r\n        )}\r\n        <TextField\r\n          fullWidth\r\n          margin=\"dense\"\r\n          variant=\"outlined\"\r\n          onChange={handleOnChange}\r\n          value={values.password}\r\n          label=\"Password\"\r\n          name=\"password\"\r\n          type=\"password\"\r\n          error={errors.password}\r\n          helperText={errors.password}\r\n        />\r\n      </div>\r\n    );\r\n  };\r\n\r\n  return (\r\n    <div className={classes.Login}>\r\n      <Box maxWidth={300}>\r\n        <Typography variant=\"h6\" gutterBottom>\r\n          {isRegister ? \"Join\" : \"Login\"}\r\n        </Typography>\r\n        <form onSubmit={onSubmit}>\r\n          {renderFields()}\r\n          <Typography align=\"center\" variant=\"body2\" gutterBottom>\r\n            {isRegister ? (\r\n              <MuiLink align=\"center\" component={Link} to=\"/\">\r\n                Already have an account?\r\n              </MuiLink>\r\n            ) : (\r\n              <MuiLink align=\"center\" component={Link} to=\"/registration\">\r\n                Not a member?\r\n              </MuiLink>\r\n            )}\r\n          </Typography>\r\n          <Button type=\"submit\" fullWidth>\r\n            {isRegister ? \"Join\" : \"Login\"}\r\n          </Button>\r\n        </form>\r\n      </Box>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default Login;\r\n"],"sourceRoot":""}