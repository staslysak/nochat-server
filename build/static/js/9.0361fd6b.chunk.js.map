{"version":3,"sources":["graphql/mutations.js","pages/VerifyUser/index.js"],"names":["REGISTER","gql","LOGIN","VERIFY_USER","CREATE_DIRECT","CREATE_MESSAGE","DELETE_MESSAGE","DELETE_DIRECT","READ_MESSAGE","LOGOUT","USER_TYPING","VerifyUser","props","useMutation","onCompleted","data","a","authTokens","set","verifyUser","history","push","onError","err","console","log","React","useEffect","token","pasreQuery","location","variables","secret"],"mappings":"irEAEO,IAAMA,EAAWC,IAAH,KAMRC,EAAQD,IAAH,KASLE,EAAcF,IAAH,KASXG,EAAgBH,IAAH,KAQbI,EAAiBJ,IAAH,KAMdK,EAAiBL,IAAH,KAMdM,EAAgBN,IAAH,KAMbO,EAAeP,IAAH,KAMZQ,EAASR,IAAH,KAMNS,EAAcT,IAAH,M,0HCvCTU,UApBI,SAACC,GAAW,IAAD,EACPC,YAAYV,IAAa,CAC5CW,YAAY,WAAD,4BAAE,WAAOC,GAAP,SAAAC,EAAA,sDACXC,IAAWC,IAAIH,EAAKI,YACpBP,EAAMQ,QAAQC,KAAK,OAFR,2CAAF,mDAAC,GAIZC,QAAS,SAACC,GACRX,EAAMQ,QAAQC,KAAK,UACnBG,QAAQC,IAAI,kBAAmBF,MAP5BJ,EADqB,oBAiB5B,OALAO,IAAMC,WAAU,WAAO,IACbC,EAAUC,YAAWjB,EAAMkB,UAA3BF,MACRT,EAAW,CAAEY,UAAW,CAAEC,OAAQJ,OACjC,CAACT,IAEG","file":"static/js/9.0361fd6b.chunk.js","sourcesContent":["import gql from \"graphql-tag\";\r\n\r\nexport const REGISTER = gql`\r\n  mutation register($username: String!, $email: String!, $password: String!) {\r\n    register(username: $username, email: $email, password: $password)\r\n  }\r\n`;\r\n\r\nexport const LOGIN = gql`\r\n  mutation login($username: String!, $password: String!) {\r\n    login(username: $username, password: $password) {\r\n      token\r\n      refreshToken\r\n    }\r\n  }\r\n`;\r\n\r\nexport const VERIFY_USER = gql`\r\n  mutation verifyUser($secret: String!) {\r\n    verifyUser(secret: $secret) {\r\n      token\r\n      refreshToken\r\n    }\r\n  }\r\n`;\r\n\r\nexport const CREATE_DIRECT = gql`\r\n  mutation createDirect($userId: Int!, $text: String) {\r\n    createDirect(userId: $userId, text: $text) {\r\n      id\r\n    }\r\n  }\r\n`;\r\n\r\nexport const CREATE_MESSAGE = gql`\r\n  mutation createMessage($chatId: Int, $text: String!) {\r\n    createMessage(chatId: $chatId, text: $text)\r\n  }\r\n`;\r\n\r\nexport const DELETE_MESSAGE = gql`\r\n  mutation deleteMessage($id: Int!) {\r\n    deleteMessage(id: $id)\r\n  }\r\n`;\r\n\r\nexport const DELETE_DIRECT = gql`\r\n  mutation deleteDirect($id: Int!) {\r\n    deleteDirect(id: $id)\r\n  }\r\n`;\r\n\r\nexport const READ_MESSAGE = gql`\r\n  mutation readMessage($id: Int!) {\r\n    readMessage(id: $id)\r\n  }\r\n`;\r\n\r\nexport const LOGOUT = gql`\r\n  mutation logout {\r\n    logout\r\n  }\r\n`;\r\n\r\nexport const USER_TYPING = gql`\r\n  mutation userTyping($chatId: Int!, $username: String) {\r\n    userTyping(chatId: $chatId, username: $username)\r\n  }\r\n`;\r\n","import React from \"react\";\r\nimport { useMutation } from \"@apollo/react-hooks\";\r\nimport { VERIFY_USER } from \"graphql/mutations\";\r\nimport { pasreQuery, authTokens } from \"utils/index\";\r\n\r\nconst VerifyUser = (props) => {\r\n  const [verifyUser] = useMutation(VERIFY_USER, {\r\n    onCompleted: async (data) => {\r\n      authTokens.set(data.verifyUser);\r\n      props.history.push(\"/me\");\r\n    },\r\n    onError: (err) => {\r\n      props.history.push(\"/login\");\r\n      console.log(\"VerifyUserERROR\", err);\r\n    },\r\n  });\r\n\r\n  React.useEffect(() => {\r\n    const { token } = pasreQuery(props.location);\r\n    verifyUser({ variables: { secret: token } });\r\n  }, [verifyUser]);\r\n\r\n  return null;\r\n};\r\n\r\nexport default VerifyUser;\r\n"],"sourceRoot":""}