/*! For license information please see 4.38815ab2.chunk.js.LICENSE.txt */
(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[4],{113:function(e,t,a){"use strict";a.r(t);var n=a(69);a.d(t,"default",(function(){return n.a}))},203:function(e,t){e.exports=function(e){return e&&e.__esModule?e:{default:e}}},207:function(e,t,a){"use strict";var n=a(203);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=n(a(0)),c=(0,n(a(208)).default)(r.default.createElement("path",{d:"M2.01 21L23 12 2.01 3 2 10l15 2-15 2z"}),"Send");t.default=c},208:function(e,t,a){"use strict";var n=a(203);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){var a=c.default.memo(c.default.forwardRef((function(t,a){return c.default.createElement(i.default,(0,r.default)({ref:a},t),e)})));0;return a.muiName=i.default.muiName,a};var r=n(a(209)),c=n(a(0)),i=n(a(113))},209:function(e,t){function a(){return e.exports=a=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e},a.apply(this,arguments)}e.exports=a},210:function(e,t,a){var n;!function(){"use strict";var a={}.hasOwnProperty;function r(){for(var e=[],t=0;t<arguments.length;t++){var n=arguments[t];if(n){var c=typeof n;if("string"===c||"number"===c)e.push(n);else if(Array.isArray(n)&&n.length){var i=r.apply(null,n);i&&e.push(i)}else if("object"===c)for(var s in n)a.call(n,s)&&n[s]&&e.push(s)}}return e.join(" ")}e.exports?(r.default=r,e.exports=r):void 0===(n=function(){return r}.apply(t,[]))||(e.exports=n)}()},223:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),c=a(61),i=a(31),s=a(16),o=a(56),u=a(197),l=a(17),d=a(151),f=a(188),p=a(95),b=a(52),g=a(178),h=Object(g.a)((function(e){return{ChatWindow:{position:"relative",height:"100%",maxHeight:"calc(100% - 65px)",display:"flex",flexDirection:"column"},ChatWindow_input_wrapper:{alignSelf:"flex-end",display:"flex",alignItems:"center",width:"100%",borderTop:"1px solid ".concat(e.palette.divider),"& .MuiInputBase-root":{fontSize:e.typography.body2.fontSize}},ChatWindow_input:{minHeight:64,padding:"".concat(e.spacing(1),"px ").concat(e.spacing(1.5),"px ").concat(e.spacing(.5),"px ").concat(e.spacing(2),"px"),"& .MuiInputBase-inputMultiline":{"&::-webkit-scrollbar":{display:"none"}}},ChatWindow_empty:{height:"100%",display:"flex",alignItems:"center",justifyContent:"center"},ChatWindow_content:{display:"flex",flexDirection:"column",height:"100%",overflow:"auto",background:"transparent",padding:e.spacing(2),"&::-webkit-scrollbar":{width:5,background:"transparent","&-thumb":{background:"dark"===e.palette.type?e.lighten(e.palette.background.default,.235):e.darken(e.palette.background.default,.057),borderRadius:3*e.shape.borderRadius,display:"none"}},"&:hover::-webkit-scrollbar-thumb":{display:"block"}}}})),m=function(e){var t=h(),a=r.a.createRef(),n=r.a.useCallback((function(){a.current&&(a.current.scrollTop=a.current.scrollHeight)}),[e.children]);return r.a.useEffect((function(){n()}),[a,n]),r.a.createElement("div",{className:t.ChatWindow},r.a.createElement("div",{className:t.ChatWindow_content,ref:a},e.children))},v=a(59),y=a.n(v),x=a(77),w=a(198),D=a(192),O=a(207),j=a.n(O),M=a(45),k=Object(M.g)((function(e){var t=h(),a=r.a.createRef();r.a.useEffect((function(){a.current&&a.current.focus()}),[e.location]);return r.a.createElement("div",{className:t.ChatWindow_input_wrapper},r.a.createElement(w.a,{fullWidth:!0,multiline:!0,rowsMax:5,inputRef:a,value:e.value,onChange:e.onChange,onKeyPress:e.onKeyPress,placeholder:"Write a message...",className:t.ChatWindow_input}),r.a.createElement(D.a,{onClick:function(t){return Object(x.a)(y.a.mark((function a(){return y.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:t.current&&t.current.focus(),e.onClick();case 2:case"end":return a.stop()}}),a)})))}(a),disabled:!e.value.trim().length},r.a.createElement(j.a,null)))})),E=a(20),C=a(73),_=a(210),I=a.n(_),T=a(156),N=a(189),W=function(e){var t=e.anchorEl,a=e.onClose,n=e.onDelete,c=e.onCopy,i=function(e){return function(){e(),a()}};return r.a.createElement(T.a,{anchorEl:t,open:Boolean(t),onClose:a},r.a.createElement(N.a,{dense:!0,onClick:i(n)},"Delete Message"),r.a.createElement(N.a,{dense:!0,onClick:i(c)},"Copy Text"))},P=Object(g.a)((function(e){return{Message:{display:"flex",position:"relative",maxWidth:"70%",padding:"".concat(e.spacing(1),"px ").concat(e.spacing(1.5),"px ").concat(e.spacing(.5),"px"),borderRadius:3*e.shape.borderRadius,"&:before":{position:"absolute",bottom:-1,width:15,height:20,content:"''"},"& p":{alignSelf:"flex-end",wordWrap:"break-word",overflowWrap:"break-word",paddingBottom:e.spacing(2),minWidth:20},"& span":{alignSelf:"flex-end",opacity:.54}},Message_content:{display:"flex",margin:"".concat(e.spacing(1),"px 0")},Message_content_receiver:{justifyContent:"flex-start"},Message_content_sender:{justifyContent:"flex-end"},Message_receiver:{background:"dark"===e.palette.type?e.lighten(e.palette.background.default,.235):e.darken(e.palette.background.default,.057),"&:before":{left:-10,transform:"rotate(-15deg)",borderBottom:"15px solid ".concat("dark"===e.palette.type?e.lighten(e.palette.background.default,.235):e.darken(e.palette.background.default,.057)),borderLeft:"15px solid transparent"}},Message_sender:{background:e.palette.secondary.dark,color:e.palette.getContrastText(e.palette.secondary.dark),"&:before":{right:-10,transform:"rotate(15deg)",borderBottom:"15px solid ".concat(e.palette.secondary.dark),borderRight:"15px solid transparent"}}}})),R=function(e){var t,a,n=P(),i=r.a.useState(null),s=Object(l.a)(i,2),o=s[0],u=s[1];return r.a.createElement("div",{className:I()(n.Message_content,(t={},Object(E.a)(t,n.Message_content_sender,e.isOwner),Object(E.a)(t,n.Message_content_receiver,!e.isOwner),t))},r.a.createElement("div",{onContextMenu:function(e){e.preventDefault(),u(e.currentTarget)},className:I()(n.Message,(a={},Object(E.a)(a,n.Message_sender,e.isOwner),Object(E.a)(a,n.Message_receiver,!e.isOwner),a))},r.a.createElement(C.a,{variant:"body2"},e.text),r.a.createElement(C.a,{variant:"caption"},Object(c.a)(e.date))),r.a.createElement(W,Object.assign({anchorEl:o,onClose:function(){return u(null)}},e.menuProps,{onCopy:function(){navigator.clipboard.writeText(e.text)}})))},S=Object(g.a)((function(e){return{DirectFallback:{height:"100%",display:"flex",justifyContent:"center",alignItems:"center"}}})),B=function(){var e=S();return r.a.createElement("div",{className:e.DirectFallback},r.a.createElement(C.a,{variant:"body2"},"No messages here yet..."))},K=Object(g.a)((function(){return{DirectChat_header:{width:"100%",paddingLeft:0,paddingRight:0}}})),Q=function(e){var t=K(),a=r.a.useState(""),n=Object(l.a)(a,2),i=n[0],s=n[1];r.a.useEffect((function(){var t=function(){};return e.chatId&&(t=e.subscribeToNewMessage(e.chatId)),function(){return t(e.chatId)}}),[e.chatId]),r.a.useEffect((function(){var t=function(){};return e.chatId&&(t=e.subscribeToDeleteMessage(e.chatId)),function(){return t(e.chatId)}}),[e.chatId]),r.a.useEffect((function(){var t=function(){};return e.chatId&&(t=e.subscribeToDeleteDirect(e.chatId)),function(){return t(e.chatId)}}),[e.chatId]),r.a.useEffect((function(){var t=e.subscribeToNewDirect();return function(){return t()}}),[]);var o=function(){i.trim().length&&e.onCreateMessage(i),s("")},u=r.a.useMemo((function(){return e.messages&&e.messages.map((function(t){return r.a.createElement(R,{key:t.id,text:t.text,date:t.createdAt,isOwner:t.userId===e.user.id,menuProps:{onDelete:e.onDeleteMessage(t.id)}})}))}),[e.messages]);return r.a.createElement(p.a,{show:e.show,header:r.a.createElement(d.a,{dense:!0,className:t.DirectChat_header},r.a.createElement(f.a,{primary:e.recipient.username,primaryTypographyProps:{component:"div"},secondary:e.recipient.online?"online":Object(c.a)(e.recipient.lastSeen,"last seen "),secondaryTypographyProps:{variant:"caption",style:e.recipient.online?{color:"#90caf9"}:{}}}),r.a.createElement(b.a,{src:e.recipient.avatar,alt:e.recipient.username,online:e.recipient.online}))},r.a.createElement(m,null,e.messages?u:r.a.createElement(B,null)),r.a.createElement(k,{value:i,onChange:function(e){return s(e.target.value)},onKeyPress:function(e){"Enter"!==e.key||e.shiftKey||(e.preventDefault(),o())},onClick:o}))},z=a(94),A=function(e){var t=e.userId,a=Object(z.a)({userId:t}),n=a.queries,c=n.currentUser,l=n.currentDirect,d=a.mutations,f=d.createDirect,p=d.createMessage,b=d.deleteMessage,g=Object(u.a)(l,"data.currentDirect.direct",{}),h=Object(u.a)(l,"data.currentDirect.recipient",{});return r.a.createElement(Q,{user:Object(u.a)(c,"data.currentUser",{}),show:!!t,chatId:Object(u.a)(g,"id"),recipient:h,messages:Object(u.a)(g,"messages"),onCreateMessage:function(e){g?p({variables:{text:e,chatId:g.id}}):f({variables:{text:e,userId:h.id}})},onDeleteMessage:function(e){return function(){b({variables:{id:e}})}},subscribeToNewDirect:function(){return l.subscribeToMore({document:o.c,updateQuery:function(e,t){var a=t.subscriptionData;if(!a.data)return e;var n=a.data.newDirect,r=[n.lastMessage];return{currentDirect:Object(s.a)({},e.currentDirect,{direct:Object(s.a)({},n,{messages:r})})}}})},subscribeToNewMessage:function(e){return l.subscribeToMore({document:o.d,variables:{chatId:e},updateQuery:function(e,t){var a=t.subscriptionData;if(!a.data)return e;var n=a.data.newMessage;return{currentDirect:Object(s.a)({},e.currentDirect,{direct:Object(s.a)({},e.currentDirect.direct,{messages:[].concat(Object(i.a)(e.currentDirect.direct.messages),[n])})})}}})},subscribeToDeleteMessage:function(e){return l.subscribeToMore({document:o.b,variables:{chatId:e},updateQuery:function(e,t){var a=t.subscriptionData;if(!a.data)return e;var n=a.data.deleteMessage,r=e.currentDirect.direct.messages.filter((function(e){return e.id!==n.id}));return{currentDirect:Object(s.a)({},e.currentDirect,{direct:Object(s.a)({},e.currentDirect.direct,{messages:r})})}}})},subscribeToDeleteDirect:function(e){return l.subscribeToMore({document:o.a,variables:{chatId:e},updateQuery:function(t,a){var n=a.subscriptionData;return n.data&&n.data.deleteDirect.id===e?{currentDirect:Object(s.a)({},t.currentDirect,{direct:null})}:t}})}})};t.default=function(e){var t=Object(c.b)(e.location).p;return r.a.createElement(A,{userId:t})}}}]);
//# sourceMappingURL=4.38815ab2.chunk.js.map