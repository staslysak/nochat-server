{"version":3,"sources":["pages/Login/index.js"],"names":["useStyles","makeStyles","theme","Login","display","justifyContent","flexDirection","alignItems","height","width","connect","dispatchLogin","props","classes","React","useState","errors","state","setstate","useMutation","CREATE_USER","createUser","LOGIN","loginUser","handleOnChange","target","name","value","handleErrors","handleData","data","a","test","location","pathname","history","push","onSubmit","e","preventDefault","variables","then","alert","catch","error","gqlError","graphQLErrors","extensions","validationErrors","login","className","maxWidth","variant","gutterBottom","username","email","password","margin","fullWidth","onChange","label","helperText","type","renderFields","align","component","Link","to"],"mappings":"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","file":"static/js/6.6450dc35.chunk.js","sourcesContent":["import React from \"react\";\r\nimport {\r\n  Box,\r\n  Button,\r\n  TextField,\r\n  Typography,\r\n  Link as MuiLink,\r\n} from \"@material-ui/core\";\r\nimport { Link } from \"react-router-dom\";\r\nimport { useMutation } from \"@apollo/react-hooks\";\r\nimport { CREATE_USER, LOGIN } from \"graphql/mutations\";\r\nimport { connect } from \"react-redux\";\r\nimport { dispatchLogin } from \"redux/actions\";\r\nimport { makeStyles } from \"@material-ui/core/styles\";\r\n\r\nconst useStyles = makeStyles((theme) => ({\r\n  Login: {\r\n    display: \"flex\",\r\n    justifyContent: \"center\",\r\n    flexDirection: \"column\",\r\n    alignItems: \"center\",\r\n    height: \"100vh\",\r\n    width: \"100vw\",\r\n  },\r\n}));\r\n\r\nconst Login = (props) => {\r\n  const classes = useStyles();\r\n  const [state, setstate] = React.useState({ errors: {} });\r\n  const [createUser] = useMutation(CREATE_USER);\r\n  const [loginUser] = useMutation(LOGIN);\r\n\r\n  const handleOnChange = ({ target: { name, value } }) => {\r\n    setstate({ ...state, [name]: value });\r\n  };\r\n\r\n  const handleErrors = (errors) => setstate({ ...state, errors });\r\n\r\n  const handleData = async (data) => {\r\n    if (/\\/registration/.test(props.location.pathname)) {\r\n      // props.history.push(\"/\");\r\n    } else {\r\n      await props.dispatchLogin(data);\r\n      props.history.push(\"/\");\r\n    }\r\n    setstate({ ...state, errors: {} });\r\n  };\r\n\r\n  const onSubmit = async (e) => {\r\n    e.preventDefault();\r\n    if (/\\/registration/.test(props.location.pathname)) {\r\n      await createUser({ variables: state })\r\n        .then(({ data }) => handleData(data.createUser))\r\n        .then(() => alert(\"we have send an email\"))\r\n        .catch((error) => {\r\n          const gqlError = error.graphQLErrors[0];\r\n          if (gqlError) {\r\n            handleErrors(gqlError.extensions.validationErrors);\r\n          }\r\n        });\r\n    } else {\r\n      await loginUser({ variables: state })\r\n        .then(({ data }) => handleData(data.login))\r\n        .catch((error) => {\r\n          const gqlError = error.graphQLErrors[0];\r\n          if (gqlError) {\r\n            handleErrors(gqlError.extensions.validationErrors);\r\n          }\r\n        });\r\n    }\r\n  };\r\n\r\n  const renderFields = () => {\r\n    const { username, email, password, errors } = state;\r\n    return (\r\n      <div>\r\n        <TextField\r\n          margin=\"dense\"\r\n          variant=\"outlined\"\r\n          fullWidth\r\n          onChange={handleOnChange}\r\n          value={username}\r\n          label=\"Username\"\r\n          name=\"username\"\r\n          error={errors.username}\r\n          helperText={errors.username}\r\n        />\r\n        {/\\/registration/.test(props.location.pathname) && (\r\n          <TextField\r\n            margin=\"dense\"\r\n            variant=\"outlined\"\r\n            fullWidth\r\n            onChange={handleOnChange}\r\n            value={email}\r\n            label=\"Email\"\r\n            name=\"email\"\r\n            error={errors.email}\r\n            helperText={errors.email}\r\n          />\r\n        )}\r\n        <TextField\r\n          margin=\"dense\"\r\n          variant=\"outlined\"\r\n          fullWidth\r\n          onChange={handleOnChange}\r\n          value={password}\r\n          label=\"Password\"\r\n          name=\"password\"\r\n          type=\"password\"\r\n          error={errors.password}\r\n          helperText={errors.password}\r\n        />\r\n      </div>\r\n    );\r\n  };\r\n\r\n  return (\r\n    <div className={classes.Login}>\r\n      <Box maxWidth={300}>\r\n        <Typography variant=\"h6\" gutterBottom>\r\n          {/\\/registration/.test(props.location.pathname) ? \"Join\" : \"Login\"}\r\n        </Typography>\r\n        <form onSubmit={onSubmit}>\r\n          {renderFields()}\r\n          <Typography align=\"center\" variant=\"body2\" gutterBottom>\r\n            {/\\/registration/.test(props.location.pathname) ? (\r\n              <MuiLink align=\"center\" component={Link} to=\"/\">\r\n                Already have an account?\r\n              </MuiLink>\r\n            ) : (\r\n              <MuiLink align=\"center\" component={Link} to=\"/registration\">\r\n                Not a member?\r\n              </MuiLink>\r\n            )}\r\n          </Typography>\r\n          <Button type=\"submit\" fullWidth>\r\n            {/\\/registration/.test(props.location.pathname) ? \"Join\" : \"Login\"}\r\n          </Button>\r\n        </form>\r\n      </Box>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default connect(null, { dispatchLogin })(Login);\r\n"],"sourceRoot":""}